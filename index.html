<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>청주시 무장애 지도</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', 'Apple SD Gothic Neo', 'Malgun Gothic', Arial, sans-serif;
      }
      body {
        background: #f3f4f6;
        color: #111827;
      }
      .landing {
        position: fixed;
        inset: 0;
        z-index: 50;
        display: flex;
        align-items: flex-start;
        justify-content: center;
        padding: 24px;
        background: #ffffff;
        overflow-y: auto;
        opacity: 1;
        transition: opacity 0.4s ease;
      }
      .landing-hidden {
        opacity: 0;
        pointer-events: none;
      }
      .landing-inner {
        width: 100%;
        max-width: 1180px;
        background: #ffffff;
        border-radius: 0;
        box-shadow: none;
        padding: 32px 32px;
        box-sizing: border-box;
      }
      .landing-header {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 16px;
        margin-bottom: 24px;
      }
      .landing-logo {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        margin-bottom: 12px;
      }
      .landing-logo img {
        max-width: 520px;
        width: 90%;
        height: auto;
        border-radius: 12px;
        object-fit: contain;
      }
      .landing-title {
        font-size: 24px;
        font-weight: 800;
        letter-spacing: -0.03em;
      }
      .landing-subtitle {
        font-size: 14px;
        color: #4b5563;
      }
      .landing-grid {
        display: grid;
        grid-template-columns: minmax(0, 2fr) minmax(0, 1.4fr);
        gap: 24px;
        align-items: flex-start;
      }
      .landing-section-title {
        font-size: 16px;
        font-weight: 700;
        margin-bottom: 6px;
      }
      .landing-section-text {
        font-size: 14px;
        line-height: 1.7;
        color: #374151;
        margin-bottom: 16px;
      }
      .landing-section-text a {
        color: #2563eb;
        text-decoration: underline;
        text-underline-offset: 2px;
      }
      .landing-aside {
        font-size: 13px;
        line-height: 1.8;
        background: #f9fafb;
        border-radius: 12px;
        padding: 16px 18px;
        border: 1px solid #e5e7eb;
      }
      .landing-aside-title {
        font-weight: 700;
        margin-bottom: 8px;
      }
      .landing-footer {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-top: 24px;
      }
      .landing-button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 10px 20px;
        border-radius: 999px;
        border: none;
        background: #2563eb;
        color: #ffffff;
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 10px 25px rgba(37, 99, 235, 0.35);
        transition: background 0.15s ease, transform 0.1s ease, box-shadow 0.15s ease;
      }
      .landing-button:hover {
        background: #1d4ed8;
        transform: translateY(-1px);
        box-shadow: 0 12px 30px rgba(37, 99, 235, 0.45);
      }
      .landing-button:active {
        transform: translateY(0);
        box-shadow: 0 6px 15px rgba(37, 99, 235, 0.35);
      }
      .landing-disclaimer {
        font-size: 12px;
        color: #6b7280;
      }
      .landing-disclaimer strong {
        font-weight: 700;
      }
      .app {
        display: flex;
        height: 100%;
        width: 100%;
        overflow: hidden;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.4s ease;
      }
      .app-visible {
        opacity: 1;
        pointer-events: auto;
      }
      .splitter {
        width: 4px;
        background: #e5e7eb;
        cursor: col-resize;
        flex: 0 0 auto;
      }
      .splitter:hover {
        background: #cbd5f5;
      }
      .sidebar {
        display: flex;
        flex-direction: column;
        background: #fff;
        border-right: 1px solid #e5e7eb;
      }
      .sidebar.left { width: 320px; min-width: 260px; }
      .sidebar.right { width: 380px; min-width: 300px; border-right: none; border-left: 1px solid #e5e7eb; }

      .sidebar-header {
        padding: 12px 14px;
        border-bottom: 1px solid #e5e7eb;
        background: #f9fafb;
        font-weight: 600;
      }
      .tabs { display: flex; gap: 8px; }
      .tab {
        appearance: none;
        border: 1px solid #e5e7eb;
        background: #ffffff;
        padding: 6px 10px;
        border-radius: 6px;
        font-size: 13px;
        cursor: pointer;
      }
      .tab.active { background: #eef2ff; border-color: #c7d2fe; }
      .sidebar-title { margin-top: 8px; font-weight: 700; }
      .list {
        overflow: auto;
        flex: 1;
      }
      .list-item {
        display: flex;
        flex-direction: column;
        gap: 4px;
        padding: 12px 14px;
        border-bottom: 1px solid #f1f5f9;
        cursor: pointer;
      }
      .list-item:hover { background: #f8fafc; }
      .list-item.active { background: #eef2ff; }
      .list-title { font-weight: 600; font-size: 14px; color: #111827; }
      .list-sub { font-size: 12px; color: #4b5563; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

      #map { flex: 1; height: 100%; }

      .detail {
        overflow: auto;
        flex: 1;
      }
      .detail-content { padding: 14px; }
      .detail-title { font-size: 18px; font-weight: 700; margin: 0 0 8px; }
      .detail-row { margin: 8px 0; font-size: 14px; color: #111827; }
      .detail-label { display: inline-block; min-width: 110px; color: #6b7280; }
      .muted { color: #6b7280; }

      @media (max-width: 1024px) {
        .sidebar.left { width: 280px; }
      }

      @media (max-width: 768px) {
        .landing-inner {
          padding: 24px 18px;
        }
        .landing-grid {
          grid-template-columns: minmax(0, 1fr);
          gap: 20px;
        }
        .landing-title {
          font-size: 20px;
        }
        .landing-subtitle {
          font-size: 13px;
        }
        .app {
          flex-direction: column;
          height: auto;
        }

        .sidebar.left,
        .sidebar.right {
          width: 100%;
          min-width: 0;
        }

        .sidebar.right {
          border-left: none;
          border-top: 1px solid #e5e7eb;
        }

        #map {
          flex: 0 0 40vh;
          height: 40vh;
          order: 2;
        }

        .sidebar.left {
          order: 1;
          max-height: 40vh;
        }

        .sidebar.right {
          order: 3;
          max-height: 40vh;
        }
        .splitter {
          display: none;
        }
      }

      @media (min-width: 1024px) {
        .landing-inner {
          display: grid;
          grid-template-columns: minmax(0, 1.3fr) minmax(0, 2fr);
          column-gap: 20px;
          row-gap: 24px;
          align-items: flex-start;
        }

        .landing-header {
          grid-column: 1 / 2;
          grid-row: 1;
        }

        .landing-grid {
          grid-column: 2 / 3;
          grid-row: 1;
        }

        .landing-footer {
          grid-column: 1 / 2;
          grid-row: 2;
          align-self: flex-start;
        }

        .landing-logo {
          justify-content: flex-start;
        }

        .landing-button {
          align-self: flex-start;
          margin-top: 8px;
        }
      }
    </style>
  </head>
  <body>
    <div id="landing" class="landing" role="dialog" aria-modal="true" aria-labelledby="landingTitle">
      <div class="landing-inner">
        <div class="landing-header">
          <div class="landing-logo" aria-hidden="true">
            <img src="logo.png" alt="청주시 무장애 지도 로고" />
          </div>
          <div>
            <h1 id="landingTitle" class="landing-title">청주시 무장애 지도 (데모)</h1>
            <p class="landing-subtitle">모두가 안전하고 편리하게 이동할 수 있는 청주를 위해, 무장애 관광·이동 정보를 한 곳에 모은 지도입니다.</p>
          </div>
          <div class="landing-footer">
            <button id="startButton" type="button" class="landing-button">시작하기</button>
            <p class="landing-disclaimer">
              <strong>주의:</strong> 이 지도는 비공식 데모 버전으로, 내용이 정확하지 않을 수 있습니다. 2025년 12월 기준으로 작성되었으며, 실제 이용 가능 여부와 상세 정보는 각 시설 및 관련 기관에 별도 문의해 주세요.
            </p>
          </div>
        </div>
        <div class="landing-grid">
          <div>
            <div class="landing-section">
              <div class="landing-section-title">배리어프리란?</div>
              <p class="landing-section-text">
                장벽(Barrier)과 자유로움(Free)의 합성어로, 장애인, 고령자, 임산부 등 사회적 약자들이 사회생활을 하는 데 지장이 되는 물리적, 제도적, 심리적 장벽을 제거하여 모두가 편리하게 살아갈 수 있도록 하자는 운동 및 정책을 의미합니다.
              </p>
            </div>
            <div class="landing-section">
              <div class="landing-section-title">열린관광지란?</div>
              <p class="landing-section-text">
                장애인, 고령자, 영유아 동반 가족 등 모든 관광객이 이동의 불편 및 관광활동의 제약 없이 이용할 수 있는 장애물 없는 관광지입니다.
                (<a href="https://docs.google.com/spreadsheets/d/1SvFnXkrEzXcG_Zg3bJR5r0IUGSL0Dh1YUw2wjflyudY/edit?usp=sharing" target="_blank" rel="noopener noreferrer">열린관광 : 모두의 여행</a>)
              </p>
            </div>
            <div class="landing-section">
              <div class="landing-section-title">무장애 지도란?</div>
              <p class="landing-section-text">
                휠체어 이용자, 유모차를 동반한 부모, 노약자 등 이동에 제약이 있는 사람들(교통약자)이 안전하고 편리하게 다닐 수 있도록 만든 맞춤형 지도입니다.
                (<a href="https://www.kbedu.or.kr/ud/index.html" target="_blank" rel="noopener noreferrer">우리동네 무장애지도</a>)
              </p>
            </div>
          </div>
          <aside class="landing-aside" aria-label="참고 정보">
            <div class="landing-aside-title">청주시 무장애 도시 조성 조례</div>
            <p>
              청주시의 무장애 도시 조성에 관한 자세한 내용은 아래 링크에서 확인하실 수 있습니다.
              <br />
              <a href="https://www.elis.go.kr/allalr/selectAlrBdtOne?alrNo=43990207342020&histNo=001" target="_blank" rel="noopener noreferrer">조례 전문 보기</a>
            </p>
          </aside>
        </div>
      </div>
    </div>
    <div class="app">
        <aside class="sidebar left" aria-label="목록">
          <div class="sidebar-header">
            <div class="tabs" role="tablist" aria-label="데이터셋 선택">
              <button id="tabTour" class="tab active" role="tab" aria-selected="true">관광지</button>
              <button id="tabFood" class="tab" role="tab" aria-selected="false">식당/카페</button>
            </div>
            <div id="sidebarTitle" class="sidebar-title">관광지 목록</div>
          </div>
          <div id="placeList" class="list" role="list"></div>
        </aside>
        <div class="splitter" id="splitterLeft" aria-hidden="true"></div>
        <div id="map" role="region" aria-label="지도"></div>
        <div class="splitter" id="splitterRight" aria-hidden="true"></div>
      <aside class="sidebar right" aria-label="관광지 상세">
        <div class="sidebar-header">상세 정보</div>
        <div id="detail" class="detail">
          <div class="detail-content muted">왼쪽 목록이나 지도 마커를 클릭하면 상세 정보가 여기에 표시됩니다.</div>
        </div>
      </aside>
    </div>

    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
    <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>

    <script>
// 설정: 데이터셋 (파일 경로 및 마커 색상)
const DATASETS = {
    tour: { url: 'data.csv', title: '관광지 목록', color: '#2563eb' },
    // 식당/카페: '카페/식당' 칼럼값으로 색상 분기 (카페 진한 보라, 식당 연보라)
    food: { url: 'data1.csv', title: '식당/카페 목록', colorCafe: '#8b5cf6', colorRestaurant: '#c4b5fd' },
  };

      // CSV 헤더(한글)를 상수화
      const COL = {
        name: 'a',
        wheelchair: 'b',
        toilet: 'c',
        phone: 'd',
        address: 'e',
        desc: 'f',
        lat: 'g',
        lng: 'h',
      };

       // 지도 초기화 (청주 대략 중심; 이후 데이터로 bounds fit)
      const map = L.map('map', { zoomControl: true }).setView([36.6439, 127.4886], 12);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; OpenStreetMap 기여자'
      }).addTo(map);

      const tourIcon = L.icon({
        iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png',
        shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
        iconSize:     [25, 41],
        iconAnchor:   [12, 41],
        popupAnchor:  [1, -34],
        shadowSize:   [41, 41],
      });

      const cafeIcon = L.icon({
        iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-violet.png',
        shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
        iconSize:     [25, 41],
        iconAnchor:   [12, 41],
        popupAnchor:  [1, -34],
        shadowSize:   [41, 41],
      });

      const restaurantIcon = L.icon({
        iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-gold.png',
        shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
        iconSize:     [25, 41],
        iconAnchor:   [12, 41],
        popupAnchor:  [1, -34],
        shadowSize:   [41, 41],
      });

const markers = [];
let loadedTour = false;
let loadedFood = false;
const listEl = document.getElementById('placeList');
const detailEl = document.getElementById('detail');
const sidebarTitleEl = document.getElementById('sidebarTitle');
const tabTourEl = document.getElementById('tabTour');
const tabFoodEl = document.getElementById('tabFood');
let currentType = 'tour';
let activeId = null;
const landingEl = document.getElementById('landing');
const startButtonEl = document.getElementById('startButton');
const appEl = document.querySelector('.app');
const leftSidebarEl = document.querySelector('.sidebar.left');
const rightSidebarEl = document.querySelector('.sidebar.right');
const splitterLeftEl = document.getElementById('splitterLeft');
const splitterRightEl = document.getElementById('splitterRight');

function hideLanding() {
  if (!landingEl) return;

  landingEl.classList.add('landing-hidden');
  landingEl.setAttribute('aria-hidden', 'true');

  if (appEl) {
    appEl.classList.add('app-visible');
  }

  const handleTransitionEnd = (event) => {
    if (event.propertyName !== 'opacity') return;
    landingEl.style.display = 'none';
    landingEl.removeEventListener('transitionend', handleTransitionEnd);
  };

  landingEl.addEventListener('transitionend', handleTransitionEnd);
}

if (startButtonEl) {
  startButtonEl.addEventListener('click', () => {
    hideLanding();
  });
}

function setupSplitter(splitterEl, side) {
  if (!splitterEl) return;

  let isDragging = false;
  let startX = 0;
  let startWidth = 0;

  const onMouseDown = (event) => {
    if (window.innerWidth < 768) return; // 모바일에서는 비활성화
    isDragging = true;
    startX = event.clientX;
    if (side === 'left' && leftSidebarEl) {
      startWidth = leftSidebarEl.getBoundingClientRect().width;
    } else if (side === 'right' && rightSidebarEl) {
      startWidth = rightSidebarEl.getBoundingClientRect().width;
    }
    document.body.style.userSelect = 'none';
  };

  const onMouseMove = (event) => {
    if (!isDragging) return;

    const dx = event.clientX - startX;
    if (side === 'left' && leftSidebarEl) {
      let newWidth = startWidth + dx;
      const min = 220;
      const max = Math.min(520, window.innerWidth * 0.6);
      newWidth = Math.max(min, Math.min(max, newWidth));
      leftSidebarEl.style.width = `${newWidth}px`;
    } else if (side === 'right' && rightSidebarEl) {
      let newWidth = startWidth - dx;
      const min = 240;
      const max = Math.min(520, window.innerWidth * 0.6);
      newWidth = Math.max(min, Math.min(max, newWidth));
      rightSidebarEl.style.width = `${newWidth}px`;
    }
  };

  const onMouseUp = () => {
    if (!isDragging) return;
    isDragging = false;
    document.body.style.userSelect = '';

    // 사이드바 폭 조절 후 지도 영역 다시 계산
    if (typeof map !== 'undefined' && map && typeof map.invalidateSize === 'function') {
      map.invalidateSize();
    }
  };

  splitterEl.addEventListener('mousedown', onMouseDown);
  window.addEventListener('mousemove', onMouseMove);
  window.addEventListener('mouseup', onMouseUp);
}

setupSplitter(splitterLeftEl, 'left');
setupSplitter(splitterRightEl, 'right');

      function createListItem(place, id) {
        const item = document.createElement('div');         item.className = 'list-item';
        item.setAttribute('role', 'listitem');
        item.dataset.id = id;

        const title = document.createElement('div');
        title.className = 'list-title';
        title.textContent = place[COL.name] || '(이름 없음)';

        const sub = document.createElement('div');
        sub.className = 'list-sub';
        const wc = place[COL.wheelchair] ? `휠체어: ${place[COL.wheelchair]}` : '';
        const toilet = place[COL.toilet] ? `화장실: ${place[COL.toilet]}` : '';
        const addr = place[COL.address] || '';
        sub.textContent = [wc, toilet, addr].filter(Boolean).join(' · ');

        item.appendChild(title);
        item.appendChild(sub);
        item.addEventListener('click', () => selectPlace(id, true));
        return item;
      }

      function renderListForCurrentType() {
        listEl.innerHTML = '';
        markers.forEach((m, id) => {
          if (!m || m.type !== currentType) return;
          const item = createListItem(m.place, id);
          listEl.appendChild(item);
        });
      }

      function renderDetail(place) {
        const name = place[COL.name] || '';
        const wheelchair = place[COL.wheelchair] || '';
        const toilet = place[COL.toilet] || '';
        const phone = place[COL.phone] || '';
        const address = place[COL.address] || '';
        const desc = place[COL.desc] || '';

        detailEl.innerHTML = `
          <div class="detail-content">
            <h2 class="detail-title">${escapeHtml(name)}</h2>
            <div class="detail-row"><span class="detail-label">휠체어 이용</span>${escapeHtml(wheelchair)}</div>
            <div class="detail-row"><span class="detail-label">장애인 화장실</span>${escapeHtml(toilet)}</div>
            <div class="detail-row"><span class="detail-label">연락처</span>${escapeHtml(phone)}</div>
            <div class="detail-row"><span class="detail-label">주소</span>${escapeHtml(address)}</div>
            <div class="detail-row"><span class="detail-label">설명</span>${escapeHtml(desc)}</div>
          </div>
        `;
      }

      function escapeHtml(str) {
        return String(str || '')
          .replaceAll('&', '&amp;')
          .replaceAll('<', '&lt;')
          .replaceAll('>', '&gt;')
          .replaceAll('"', '&quot;')
          .replaceAll("'", '&#039;');
      } 
      function selectPlace(id, fromList = false) {
        const m = markers[id];
        if (!m) return;

        // 목록 하이라이트
        if (activeId !== null) {
          const prev = listEl.querySelector(`.list-item[data-id="${activeId}"]`);
          if (prev) prev.classList.remove('active');
        }
        const cur = listEl.querySelector(`.list-item[data-id="${id}"]`);
        if (cur) {
          cur.classList.add('active');
          cur.scrollIntoView({ block: 'nearest' });
        }
        activeId = id;

        // 상세 정보 렌더
        renderDetail(m.place);

        // 지도 이동 및 팝업 - 선택한 장소가 항상 화면 중앙에 오도록 처리
        const latlng = m.marker.getLatLng();
        const targetZoom = Math.max(map.getZoom(), 17);
        map.once('moveend', () => {
          m.marker.openPopup();
        });
        // duration 기본값(약 1초)보다 짧게 설정해서 이동 속도를 빠르게 함
        map.flyTo(latlng, targetZoom, { animate: true, duration: 0.5 });
      }

    function addMarker(place, id) {
        const lat = parseFloat(place[COL.lat]);
        const lng = parseFloat(place[COL.lng]);
        if (Number.isNaN(lat) || Number.isNaN(lng)) return null;

        const popupHtml = `
          <div>
            <div style="font-weight:700;margin-bottom:4px;">${escapeHtml(place[COL.name] || '')}</div>
            <div class="muted" style="font-size:12px;">${escapeHtml(place[COL.address] || '')}</div>
            <div style="margin-top:6px;font-size:12px;">
              휠체어: ${escapeHtml(place[COL.wheelchair] || '')} · 화장실: ${escapeHtml(place[COL.toilet] || '')}
            </div>
          </div>
        `;

      let icon = tourIcon;
      const typeField = place['i'];
      if (typeField !== undefined && typeField !== null) {
        const t = typeField.toString().trim();
        if (t.includes('식당')) icon = restaurantIcon;
        else icon = cafeIcon;
      }

      const marker = L.marker([lat, lng], { icon });
      marker.bindPopup(popupHtml);
      marker.addTo(map);
      marker.on('click', () => selectPlace(id));

      return marker;
      }

function clearAll() {
  listEl.innerHTML = '';
  detailEl.innerHTML = '<div class="detail-content muted">왼쪽 목록이나 지도 마커를 클릭하면 상세 정보가 여기에 표시됩니다.</div>';
  activeId = null;
}

        function loadCSV(type, options = {}) {
          const { fitBounds = true, renderList = true } = options;
          const dataset = DATASETS[type];
          if (!dataset) return;

          if (type === currentType) {
            sidebarTitleEl.textContent = dataset.title;
          }

          const url = dataset.url;
          Papa.parse(url, {
            download: true,
            header: true,
            skipEmptyLines: true,
            complete: (res) => {
            const data = res.data || [];
            const bounds = L.latLngBounds();

              data.forEach((row) => {
              const id = markers.length;
              const marker = addMarker(row, id);
              if (marker) {
                markers[id] = { marker, place: row, type };
                bounds.extend(marker.getLatLng());
              }
            });

            if (fitBounds && bounds.isValid()) {
              map.fitBounds(bounds.pad(0.08));
            }

            if (type === 'tour') loadedTour = true;
            if (type === 'food') loadedFood = true;

            if (renderList && type === currentType) {
              renderListForCurrentType();
            }
          },
            error: (err) => {
            console.error('CSV 로드 실패:', err);
            detailEl.innerHTML = '<div class="detail-content">데이터 로드를 실패했습니다. 경로를 확인해 주세요.</div>';
          }
        });
      }

      function setActiveTab(type) {
        currentType = type;
        tabTourEl.classList.toggle('active', type === 'tour');
        tabTourEl.setAttribute('aria-selected', String(type === 'tour'));
        tabFoodEl.classList.toggle('active', type === 'food');
        tabFoodEl.setAttribute('aria-selected', String(type === 'food'));
      }

      function loadTourPlaces() {
        currentType = 'tour';
        setActiveTab('tour');
        clearAll();
        if (!loadedTour) {
          loadCSV('tour', { fitBounds: true, renderList: true });
        } else {
          sidebarTitleEl.textContent = DATASETS['tour'].title;
          renderListForCurrentType();
        }
      }

      function loadFoodPlaces() {
        currentType = 'food';
        setActiveTab('food');
        clearAll();
        if (!loadedFood) {
          loadCSV('food', { fitBounds: true, renderList: true });
        } else {
          sidebarTitleEl.textContent = DATASETS['food'].title;
          renderListForCurrentType();
        }
      }

      tabTourEl.addEventListener('click', () => {
        if (currentType !== 'tour') {
          loadTourPlaces();
        }
      });
      tabFoodEl.addEventListener('click', () => {
        if (currentType !== 'food') {
          loadFoodPlaces();
        }
      });

      setActiveTab('tour');
      loadCSV('tour', { fitBounds: true, renderList: true });
      loadCSV('food', { fitBounds: false, renderList: false });
    </script>
  </body>
</html>
