<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>청주 무장애 지도 (Leaflet 버전)</title>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
  body { margin:0; padding:0; }
  #map { width:100%; height:100vh; }
</style>
</head>
<body>
<div id="map"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- PapaParse (CSV 파싱) -->
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>

<script>
// 지도 생성: OpenStreetMap 타일 사용
const map = L.map('map').setView([36.63, 127.49], 12);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
}).addTo(map);

// CSV 불러오기
Papa.parse("data.csv", {
    download: true,
    header: true,
    skipEmptyLines: true,
    complete: function(results) {
        const data = results.data;
        let bounds = [];

        data.forEach(row => {
            const lat = parseFloat(row.lat);
            const lng = parseFloat(row.lng);
            if (isNaN(lat) || isNaN(lng)) return;

            const marker = L.marker([lat, lng]).addTo(map);

            const html = `
                <b>${row.name || ''}</b><br>
                장애유형: ${row.disability_type || ''}<br>
                접근성: ${row.accessibility || ''}<br>
                주소: ${row.address || ''}<br>
                전화: ${row.phone || ''}<br>
                운영시간: ${row.opening_hours || ''}<br>
                설명: ${row.info || ''}<br>
            `;
            marker.bindPopup(html);

            bounds.push([lat, lng]);
        });

        if (bounds.length > 0) {
            map.fitBounds(bounds);
        }
    }
});
</script>
</body>
</html>
